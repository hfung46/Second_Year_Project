#include <NewPing.h>
#include <Servo.h>

#include "Gyro.h"
#include <Wire.h>

MPU6050 mpu6050(Wire);

const int ci_Trigger_Left = 2;
const int ci_Echo_Left = 3 ;
const int ci_Trigger_Right = 4;
const int ci_Echo_Right = 5;
const int ci_Ultrasonics = 9;
const int ci_Max_Distance = 400;


NewPing Sonar_Left(ci_Trigger_Left, ci_Echo_Left, ci_Max_Distance);
NewPing Sonar_Right(ci_Trigger_Right, ci_Echo_Right, ci_Max_Distance);

Servo servo_Ultrasonic;

unsigned int ui_Dist_Left, ui_Dist_Right;
unsigned int ui_Pos;

unsigned long ul_Delay_Time;

void setup() {
  Serial.begin(9600);
  Wire.begin();
  mpu6050.begin();
  mpu6050.calcGyroOffsets(true);
  mpu6050.update();
  mpu6050.zero();
  servo_Ultrasonic.attach(ci_Ultrasonics);
  ul_Delay_Time = millis();
}

void loop() {
  mpu6050.update();
  //Serial.print("\tangleZ : ");
  //Serial.println(mpu6050.getAngleZ());
  //mpu6050.getDirection();

  servo_Ultrasonic.write(ui_Pos);
  if (millis() - ul_Delay_Time >= 200) {
    ul_Delay_Time = millis();
    ui_Dist_Left = Sonar_Left.ping_cm();
    ui_Dist_Right = Sonar_Right.ping_cm();
    ui_Pos += 30;
    if (ui_Pos == 180) {
      ui_Pos = 0;
    }
  }
}
